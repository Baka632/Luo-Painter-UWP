<Grid
    x:Class="Luo_Painter.Controls.LayerListView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="using:Luo_Painter.Controls"
    xmlns:elements="using:Luo_Painter.Elements"
    xmlns:layers="using:Luo_Painter.Layers"
    mc:Ignorable="d"
    d:DesignHeight="50"
    d:DesignWidth="50"  
    Margin="0,49" 
    Width="211" 
    MinHeight="100" 
    HorizontalAlignment="Right"
    VerticalAlignment="Stretch" 
    BorderThickness="1,0,0,0" 
    BorderBrush="{ThemeResource AppStroke}" 
    Background="{ThemeResource AppBackground}"
    >

    <FrameworkElement.Resources>
        <!--Storyboard-->
        <Storyboard x:Name="HideStoryboard" >
            <DoubleAnimation Duration="0:0:0.1" By="{x:Null}" To="210" Storyboard.TargetProperty="X" Storyboard.TargetName="TranslateTransform" d:IsOptimized="True"/>
            <ObjectAnimationUsingKeyFrames BeginTime="0:0:0.1" Storyboard.TargetName="ListView" Storyboard.TargetProperty="Width">
                <DiscreteObjectKeyFrame KeyTime="0" Value="70" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames BeginTime="0:0:0.1" Storyboard.TargetName="SelectedButton" Storyboard.TargetProperty="Visibility">
                <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Name="NoneStoryboard" >
            <DoubleAnimation Duration="0:0:0.15" By="{x:Null}" To="140" Storyboard.TargetProperty="X" Storyboard.TargetName="TranslateTransform" d:IsOptimized="True"/>
            <ObjectAnimationUsingKeyFrames BeginTime="0:0:0.15" Storyboard.TargetName="ListView" Storyboard.TargetProperty="Width">
                <DiscreteObjectKeyFrame KeyTime="0" Value="70" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames BeginTime="0:0:0.1" Storyboard.TargetName="SelectedButton" Storyboard.TargetProperty="Visibility">
                <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Name="ExpandStoryboard" >
            <DoubleAnimation Duration="0:0:0.15" By="{x:Null}" To="0" Storyboard.TargetProperty="X" Storyboard.TargetName="TranslateTransform" d:IsOptimized="True"/>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ListView" Storyboard.TargetProperty="Width">
                <DiscreteObjectKeyFrame KeyTime="0" Value="210" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames BeginTime="0:0:0.1" Storyboard.TargetName="SelectedButton" Storyboard.TargetProperty="Visibility">
                <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>
    </FrameworkElement.Resources>

    <UIElement.RenderTransformOrigin>
        0.5,0.5
    </UIElement.RenderTransformOrigin>
    <UIElement.RenderTransform>
        <TranslateTransform x:Name="TranslateTransform" X="140"/>
    </UIElement.RenderTransform>

    <ListView x:Name="ListView" 
                      Margin="0,50"
                      Width="70"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Stretch"
                      
                      IsItemClickEnabled="True"
                      SelectionMode="Extended"   
              
                      AllowDrop="True" 
                      CanDragItems="True"
                      CanReorderItems="True" 
                      ReorderMode="Enabled"   
           
                      ScrollViewer.VerticalScrollBarVisibility="Hidden"
                      >

        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <ItemsStackPanel VerticalAlignment="Bottom"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>

        <ItemsControl.ItemContainerStyle>
            <Style TargetType="ListViewItem">
                <Setter Property="MinWidth" Value="70"/>
                <Setter Property="Height" Value="55"/>
                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Padding" Value="2,1"/>
                <Setter Property="Margin" Value="0"/>
                <Setter Property="Transitions">
                    <Setter.Value>
                        <TransitionCollection>

                        </TransitionCollection>
                    </Setter.Value>
                </Setter>
            </Style>
        </ItemsControl.ItemContainerStyle>

        <ItemsControl.ItemContainerTransitions>
            <TransitionCollection>

            </TransitionCollection>
        </ItemsControl.ItemContainerTransitions>

        <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="layers:ILayer">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="66"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="2" IsHitTestVisible="False" VerticalAlignment="Center" 
                                Visibility="{Binding ElementName=SelectedButton, Path=Visibility, Mode=OneWay}" >
                        <Run Text="{x:Bind Name, Mode=OneWay}"/>                                                   
                        <Run>
                            (
                        </Run><Run Text="{x:Bind Type, Mode=OneWay}"/><Run>                              
                            )       
                        </Run>
                    </TextBlock>

                    <FontIcon Grid.Column="3" IsHitTestVisible="False" Opacity="0.8" Glyph="&#x23A5;" FontSize="18" FontFamily="Segoe UI Symbol"
                               Visibility="{Binding ElementName=SelectedButton, Path=Visibility, Mode=OneWay}" />

                    <elements:SelectedButtonPresenter Visibility="{Binding ElementName=SelectedButton, Path=Visibility, Mode=OneWay}"/>
                    <elements:VisibleButton Grid.Column="4"
                                Visible="{x:Bind Visibility, Mode=OneWay}"
                                CommandParameter="{Binding}" 
                                Command="{Binding ElementName=VisualButton, Path=Command, Mode=OneWay}"
                                Visibility="{Binding ElementName=SelectedButton, Path=Visibility, Mode=OneWay}"
                                />

                    <Border Grid.Column="1" IsHitTestVisible="False" BorderThickness="1" BorderBrush="Black" Background="White" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Source="{x:Bind Thumbnail, Mode=OneWay}" />
                    </Border>

                </Grid>
            </DataTemplate>
        </ItemsControl.ItemTemplate>

        <ListView.Header>
            <Grid Height="55" Background="{ThemeResource AppBackgroundLight}" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="69"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="MarqueeTextBlock" Grid.Column="2" IsHitTestVisible="False" VerticalAlignment="Center" 
                                Visibility="{x:Bind SelectedButton.Visibility, Mode=OneWay}" >
                    Marquee
                </TextBlock>
                <Border Grid.Column="1" IsHitTestVisible="False" BorderThickness="1" BorderBrush="Black" Background="White" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Image x:Name="Image"/>
                </Border>
                <ContentControl x:Name="SelectedButton" Width="32" Visibility="Collapsed" Foreground="Gray" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" >
                    <SymbolIcon Symbol="SelectAll" />
                </ContentControl>
            </Grid>
        </ListView.Header>

    </ListView>

    <Button x:Name="VisualButton" Visibility="Collapsed" HorizontalAlignment="Right" VerticalAlignment="Bottom"
                    CommandParameter="{x:Null}">
        <Button.Command>
            <local:LayerCommand x:Name="VisualCommand"/>
        </Button.Command>
        <SymbolIcon Symbol="View"/>
    </Button>

    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Bottom">
        <Button x:Name="AddButton" Style="{StaticResource AppButtonStyle}">
            <UIElement.KeyboardAccelerators>
                <KeyboardAccelerator Modifiers="None" Key="Insert"/>
            </UIElement.KeyboardAccelerators>
            <SymbolIcon Symbol="Add"/>
        </Button>
        <Button x:Name="ImageButton" Style="{StaticResource AppButtonStyle}">
            <SymbolIcon Symbol="Pictures"/>
        </Button>
        <Button x:Name="RemoveButton" Style="{StaticResource AppButtonStyle}">
            <SymbolIcon Symbol="Delete"/>
        </Button>
    </StackPanel>

    <Button x:Name="SplitButton" HorizontalAlignment="Left" VerticalAlignment="Top" Style="{StaticResource AppButtonStyle}">
        <UIElement.ManipulationMode>
            TranslateX
        </UIElement.ManipulationMode>
        <SymbolIcon x:Name="SplitIcon" Symbol="GlobalNavigationButton" />
    </Button>

</Grid>